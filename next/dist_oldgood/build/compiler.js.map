{"version":3,"names":["_webpack","_interopRequireDefault","require","e","__esModule","default","generateStats","result","stat","errors","warnings","toJson","all","length","push","runCompiler","config","Promise","resolve","reject","compiler","webpack","run","err","statsOrMultiStats","stats","reduce"],"sources":["compiler.ts"],"sourcesContent":["import webpack, { Stats } from 'webpack'\n\nexport type CompilerResult = {\n  errors: Error[]\n  warnings: Error[]\n}\n\nfunction generateStats(result: CompilerResult, stat: Stats): CompilerResult {\n  const { errors, warnings } = stat.toJson({\n    all: false,\n    warnings: true,\n    errors: true,\n  })\n  if (errors.length > 0) {\n    result.errors.push(...(errors as any))\n  }\n\n  if (warnings.length > 0) {\n    result.warnings.push(...(warnings as any))\n  }\n\n  return result\n}\n\nexport function runCompiler(\n  config: webpack.Configuration | webpack.Configuration[]\n): Promise<CompilerResult> {\n  return new Promise(async (resolve, reject) => {\n    // @ts-ignore webpack allows both a single config or array of configs\n    const compiler = webpack(config)\n    compiler.run((err: Error, statsOrMultiStats: any) => {\n      if (err) {\n        return reject(err)\n      }\n\n      if (statsOrMultiStats.stats) {\n        const result: CompilerResult = statsOrMultiStats.stats.reduce(\n          generateStats,\n          { errors: [], warnings: [] }\n        )\n        return resolve(result)\n      }\n\n      const result = generateStats(\n        { errors: [], warnings: [] },\n        statsOrMultiStats\n      )\n      return resolve(result)\n    })\n  })\n}\n"],"mappings":"qEAAA,IAAAA,QAAA,CAAAC,sBAAA,CAAAC,OAAA,aAAwC,SAAAD,uBAAAE,CAAA,SAAAA,CAAA,EAAAA,CAAA,CAAAC,UAAA,CAAAD,CAAA,EAAAE,OAAA,CAAAF,CAAA,GAOxC,QAAS,CAAAG,aAAaA,CAACC,MAAsB,CAAEC,IAAW,CAAkB,CAC1E,KAAM,CAAEC,MAAM,CAAEC,QAAS,CAAC,CAAGF,IAAI,CAACG,MAAM,CAAC,CACvCC,GAAG,CAAE,KAAK,CACVF,QAAQ,CAAE,IAAI,CACdD,MAAM,CAAE,IACV,CAAC,CAAC,CACF,GAAIA,MAAM,CAACI,MAAM,CAAG,CAAC,CAAE,CACrBN,MAAM,CAACE,MAAM,CAACK,IAAI,CAAC,GAAIL,MAAc,CAAC,CACxC,CAEA,GAAIC,QAAQ,CAACG,MAAM,CAAG,CAAC,CAAE,CACvBN,MAAM,CAACG,QAAQ,CAACI,IAAI,CAAC,GAAIJ,QAAgB,CAAC,CAC5C,CAEA,MAAO,CAAAH,MAAM,CACf,CAEO,QAAS,CAAAQ,WAAWA,CACzBC,MAAuD,CAC9B,CACzB,MAAO,IAAI,CAAAC,OAAO,CAAC,MAAOC,OAAO,CAAEC,MAAM,GAAK,CAC5C;AACA,KAAM,CAAAC,QAAQ,CAAG,GAAAC,gBAAO,EAACL,MAAM,CAAC,CAChCI,QAAQ,CAACE,GAAG,CAAC,CAACC,GAAU,CAAEC,iBAAsB,GAAK,CACnD,GAAID,GAAG,CAAE,CACP,MAAO,CAAAJ,MAAM,CAACI,GAAG,CAAC,CACpB,CAEA,GAAIC,iBAAiB,CAACC,KAAK,CAAE,CAC3B,KAAM,CAAAlB,MAAsB,CAAGiB,iBAAiB,CAACC,KAAK,CAACC,MAAM,CAC3DpB,aAAa,CACb,CAAEG,MAAM,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAC7B,CAAC,CACD,MAAO,CAAAQ,OAAO,CAACX,MAAM,CAAC,CACxB,CAEA,KAAM,CAAAA,MAAM,CAAGD,aAAa,CAC1B,CAAEG,MAAM,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAC5Bc,iBACF,CAAC,CACD,MAAO,CAAAN,OAAO,CAACX,MAAM,CAAC,CACxB,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ","ignoreList":[]}