{"version":3,"names":["_chalk","_interopRequireDefault","require","_fs","_jestWorker","_mkdirp","_index","_path","_util","_formatWebpackMessages","_constants","_findPagesDir","_recursiveDelete","_recursiveReaddir","_verifyTypeScriptSetup","_constants2","_utils","_config","_interopRequireWildcard","_events","_storage","_compiler","_entries","_generateBuildId","_isWriteable","_spinner","_utils2","_webpackConfig","_chunkGraphPlugin","_writeBuildId","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","fsUnlink","promisify","fs","unlink","fsRmdir","rmdir","fsStat","stat","fsMove","rename","fsReadFile","readFile","fsWriteFile","writeFile","mkdirp","mkdirpOrig","staticCheckWorker","resolve","build","dir","conf","isWriteable","Error","buildSpinner","createSpinner","prefixText","config","loadConfig","PHASE_PRODUCTION_BUILD","target","buildId","generateBuildId","nanoid","distDir","path","join","setTelemetryDir","publicDir","pagesDir","findPagesDir","publicFiles","hasPublicDir","backgroundWork","push","recordVersion","cliCommand","recordNextPlugins","verifyTypeScriptSetup","_","recursiveReadDir","tracer","experimental","profiling","createTrace","profiler","startProfiling","isLikeServerless","isTargetLikeServerless","pagePaths","collectPages","pageExtensions","allStaticPages","Set","allPageInfos","Map","mappedPages","createPagesMapping","entrypoints","createEntrypoints","conflictingPublicFiles","PUBLIC_DIR_MIDDLEWARE_CONFLICT","err","file","replace","split","pop","numConflicting","length","configs","Promise","all","getBaseWebpackConfig","isServer","client","server","clientConfig","optimization","minimize","minimizer","console","warn","chalk","bold","yellow","webpackBuildStart","process","hrtime","result","warnings","errors","clientResult","runCompiler","serverResult","webpackBuildEnd","stopAndPersist","log","formatWebpackMessages","error","red","indexOf","page_name_regex","parsed","exec","page_name","groups","green","recordBuildDuration","totalPageCount","durationInSeconds","postBuildSpinner","pageKeys","keys","manifestPath","SERVERLESS_DIRECTORY","SERVER_DIRECTORY","PAGES_MANIFEST","buildManifestPath","BUILD_MANIFEST","sprPages","staticPages","invalidPages","hybridAmpPages","additionalSprPaths","pageInfos","pagesManifest","JSON","parse","buildManifest","customAppGetInitialProps","env","NEXT_PHASE","staticCheckWorkers","Worker","numWorkers","cpus","enableWorkerThreads","analysisBegin","map","page","chunks","getPageChunks","actualPage","size","getPageSizeInKb","modern","bundleRelative","serverBundle","isStatic","runtimeEnvConfig","publicRuntimeConfig","serverRuntimeConfig","nonReservedPage","match","undefined","hasCustomAppGetInitialProps","isPageStatic","isHybridAmp","add","prerender","prerenderRoutes","static","message","end","pg","Array","isArray","plugins","some","plugin","ampPages","forEach","isAmp","writeBuildId","finalPrerenderRoutes","tbdPrerenderRoutes","combinedPages","exportApp","exportOptions","silent","buildExport","pages","outdir","exportConfig","initialPageRevalidationMap","exportPathMap","defaultMap","isDynamicRoute","routes","route","exportTrailingSlash","moveExportedPage","isSpr","ext","orig","relativeDest","dest","dirname","isDynamic","hasAmp","initialRevalidateSeconds","srcRoute","dataRoute","posix","extraRoutes","recursiveDelete","stringify","analysisEnd","recordBuildOptimize","staticPageCount","ssrPageCount","finalDynamicRoutes","tbdRoute","routeRegex","getRouteRegex","re","source","dataRouteRegex","prerenderManifest","version","dynamicRoutes","PRERENDER_MANIFEST","info","key","printTreeView","parsedResults","stopProfiling","destroy","trace","flush","cpuStartTime","profile","startTime","cpuEndTime","endTime","completeEvent","name","id","counter","cat","ts","args","src_file","src_func","dur","data","url","lineNumber","columnNumber","frame","instantEvent","cpuProfile","catch"],"sources":["index.ts"],"sourcesContent":["import chalk from 'chalk'\nimport fs from 'fs'\nimport Worker from 'jest-worker'\nimport mkdirpOrig from 'mkdirp'\nimport nanoid from 'next/dist/compiled/nanoid/index.js'\nimport path from 'path'\nimport { promisify } from 'util'\n\nimport formatWebpackMessages from '../client/dev/error-overlay/format-webpack-messages'\nimport { PUBLIC_DIR_MIDDLEWARE_CONFLICT } from '../lib/constants'\nimport { findPagesDir } from '../lib/find-pages-dir'\nimport { recursiveDelete } from '../lib/recursive-delete'\nimport { recursiveReadDir } from '../lib/recursive-readdir'\nimport { verifyTypeScriptSetup } from '../lib/verifyTypeScriptSetup'\nimport {\n  BUILD_MANIFEST,\n  PAGES_MANIFEST,\n  PHASE_PRODUCTION_BUILD,\n  PRERENDER_MANIFEST,\n  SERVER_DIRECTORY,\n  SERVERLESS_DIRECTORY,\n} from '../next-server/lib/constants'\nimport { getRouteRegex, isDynamicRoute } from '../next-server/lib/router/utils'\nimport loadConfig, {\n  isTargetLikeServerless,\n} from '../next-server/server/config'\nimport {\n  recordBuildDuration,\n  recordBuildOptimize,\n  recordNextPlugins,\n  recordVersion,\n} from '../telemetry/events'\nimport { setDistDir as setTelemetryDir } from '../telemetry/storage'\nimport { CompilerResult, runCompiler } from './compiler'\nimport { createEntrypoints, createPagesMapping } from './entries'\nimport { generateBuildId } from './generate-build-id'\nimport { isWriteable } from './is-writeable'\nimport createSpinner from './spinner'\nimport {\n  collectPages,\n  getPageSizeInKb,\n  hasCustomAppGetInitialProps,\n  PageInfo,\n  printTreeView,\n} from './utils'\nimport getBaseWebpackConfig from './webpack-config'\nimport { getPageChunks } from './webpack/plugins/chunk-graph-plugin'\nimport { writeBuildId } from './write-build-id'\n\nconst fsUnlink = promisify(fs.unlink)\nconst fsRmdir = promisify(fs.rmdir)\nconst fsStat = promisify(fs.stat)\nconst fsMove = promisify(fs.rename)\nconst fsReadFile = promisify(fs.readFile)\nconst fsWriteFile = promisify(fs.writeFile)\nconst mkdirp = promisify(mkdirpOrig)\n\nconst staticCheckWorker = require.resolve('./utils')\n\nexport type SprRoute = {\n  initialRevalidateSeconds: number | false\n  srcRoute: string | null\n  dataRoute: string\n}\n\nexport type DynamicSprRoute = {\n  routeRegex: string\n\n  dataRoute: string\n  dataRouteRegex: string\n}\n\nexport type PrerenderManifest = {\n  version: number\n  routes: { [route: string]: SprRoute }\n  dynamicRoutes: { [route: string]: DynamicSprRoute }\n}\n\nexport default async function build(dir: string, conf = null): Promise<void> {\n  if (!(await isWriteable(dir))) {\n    throw new Error(\n      '> Build directory is not writeable. https://err.sh/zeit/next.js/build-dir-not-writeable'\n    )\n  }\n\n  const buildSpinner = createSpinner({\n    prefixText: 'Creating an optimized production build',\n  })\n\n  const config = loadConfig(PHASE_PRODUCTION_BUILD, dir, conf)\n  const { target } = config\n  const buildId = await generateBuildId(config.generateBuildId, nanoid)\n  const distDir = path.join(dir, config.distDir)\n  setTelemetryDir(distDir)\n  const publicDir = path.join(dir, 'public')\n  const pagesDir = findPagesDir(dir)\n  let publicFiles: string[] = []\n  let hasPublicDir = false\n\n  let backgroundWork: (Promise<any> | undefined)[] = []\n  backgroundWork.push(\n    recordVersion({ cliCommand: 'build' }),\n    recordNextPlugins(path.resolve(dir))\n  )\n\n  await verifyTypeScriptSetup(dir, pagesDir)\n\n  try {\n    await fsStat(publicDir)\n    hasPublicDir = true\n  } catch (_) {}\n\n  if (hasPublicDir) {\n    publicFiles = await recursiveReadDir(publicDir, /.*/)\n  }\n\n  let tracer: any = null\n  if (config.experimental.profiling) {\n    const { createTrace } = require('./profiler/profiler.js')\n    tracer = createTrace(path.join(distDir, `profile-events.json`))\n    tracer.profiler.startProfiling()\n  }\n\n  const isLikeServerless = isTargetLikeServerless(target)\n\n  const pagePaths: string[] = await collectPages(\n    pagesDir,\n    config.pageExtensions\n  )\n\n  // needed for static exporting since we want to replace with HTML\n  // files\n  const allStaticPages = new Set<string>()\n  let allPageInfos = new Map<string, PageInfo>()\n\n  const mappedPages = createPagesMapping(pagePaths, config.pageExtensions)\n  const entrypoints = createEntrypoints(mappedPages, target, buildId, config)\n  const conflictingPublicFiles: string[] = []\n\n  if (hasPublicDir) {\n    try {\n      await fsStat(path.join(publicDir, '_next'))\n      throw new Error(PUBLIC_DIR_MIDDLEWARE_CONFLICT)\n    } catch (err) {}\n  }\n\n  for (let file of publicFiles) {\n    file = file\n      .replace(/\\\\/g, '/')\n      .replace(/\\/index$/, '')\n      .split(publicDir)\n      .pop()!\n\n    if (mappedPages[file]) {\n      conflictingPublicFiles.push(file)\n    }\n  }\n  const numConflicting = conflictingPublicFiles.length\n\n  if (numConflicting) {\n    throw new Error(\n      `Conflicting public and page file${\n        numConflicting === 1 ? ' was' : 's were'\n      } found. https://err.sh/zeit/next.js/conflicting-public-file-page\\n${conflictingPublicFiles.join(\n        '\\n'\n      )}`\n    )\n  }\n\n  const configs = await Promise.all([\n    getBaseWebpackConfig(dir, {\n      tracer,\n      buildId,\n      isServer: false,\n      config,\n      target,\n      pagesDir,\n      entrypoints: entrypoints.client,\n    }),\n    getBaseWebpackConfig(dir, {\n      tracer,\n      buildId,\n      isServer: true,\n      config,\n      target,\n      pagesDir,\n      entrypoints: entrypoints.server,\n    }),\n  ])\n\n  const clientConfig = configs[0]\n\n  if (\n    clientConfig.optimization &&\n    (clientConfig.optimization.minimize !== true ||\n      (clientConfig.optimization.minimizer &&\n        clientConfig.optimization.minimizer.length === 0))\n  ) {\n    console.warn(\n      chalk.bold.yellow(`Warning: `) +\n        chalk.bold(\n          `Production code optimization has been disabled in your project. Read more: https://err.sh/zeit/next.js/minification-disabled`\n        )\n    )\n  }\n\n  const webpackBuildStart = process.hrtime()\n\n  let result: CompilerResult = { warnings: [], errors: [] }\n  // TODO: why do we need this?? https://github.com/zeit/next.js/issues/8253\n  if (isLikeServerless) {\n    const clientResult = await runCompiler(clientConfig)\n    // Fail build if clientResult contains errors\n    if (clientResult.errors.length > 0) {\n      result = {\n        warnings: [...clientResult.warnings],\n        errors: [...clientResult.errors],\n      }\n    } else {\n      const serverResult = await runCompiler(configs[1])\n      result = {\n        warnings: [...clientResult.warnings, ...serverResult.warnings],\n        errors: [...clientResult.errors, ...serverResult.errors],\n      }\n    }\n  } else {\n    result = await runCompiler(configs)\n  }\n\n  const webpackBuildEnd = process.hrtime(webpackBuildStart)\n  if (buildSpinner) {\n    buildSpinner.stopAndPersist()\n  }\n  console.log()\n\n  result = formatWebpackMessages(result)\n\n  if (result.errors.length > 0) {\n    // Only keep the first error. Others are often indicative\n    // of the same problem, but confuse the reader with noise.\n    if (result.errors.length > 1) {\n      result.errors.length = 1\n    }\n    const error = result.errors.join('\\n\\n')\n\n    console.error(chalk.red('Failed to compile.\\n'))\n\n    if (\n      error.indexOf('private-next-pages') > -1 &&\n      error.indexOf('does not contain a default export') > -1\n    ) {\n      const page_name_regex = /\\'private-next-pages\\/(?<page_name>[^\\']*)\\'/\n      const parsed = page_name_regex.exec(error)\n      const page_name = parsed && parsed.groups && parsed.groups.page_name\n      throw new Error(\n        `webpack build failed: found page without a React Component as default export in pages/${page_name}\\n\\nSee https://err.sh/zeit/next.js/page-without-valid-component for more info.`\n      )\n    }\n\n    console.error(error)\n    console.error()\n\n    if (error.indexOf('private-next-pages') > -1) {\n      throw new Error(\n        '> webpack config.resolve.alias was incorrectly overriden. https://err.sh/zeit/next.js/invalid-resolve-alias'\n      )\n    }\n    throw new Error('> Build failed because of webpack errors')\n  } else if (result.warnings.length > 0) {\n    console.warn(chalk.yellow('Compiled with warnings.\\n'))\n    console.warn(result.warnings.join('\\n\\n'))\n    console.warn()\n  } else {\n    console.log(chalk.green('Compiled successfully.\\n'))\n    backgroundWork.push(\n      recordBuildDuration({\n        totalPageCount: pagePaths.length,\n        durationInSeconds: webpackBuildEnd[0],\n      })\n    )\n  }\n\n  const postBuildSpinner = createSpinner({\n    prefixText: 'Automatically optimizing pages',\n  })\n\n  const pageKeys = Object.keys(mappedPages)\n  const manifestPath = path.join(\n    distDir,\n    isLikeServerless ? SERVERLESS_DIRECTORY : SERVER_DIRECTORY,\n    PAGES_MANIFEST\n  )\n  const buildManifestPath = path.join(distDir, BUILD_MANIFEST)\n\n  const sprPages = new Set<string>()\n  const staticPages = new Set<string>()\n  const invalidPages = new Set<string>()\n  const hybridAmpPages = new Set<string>()\n  const additionalSprPaths = new Map<string, Array<string>>()\n  const pageInfos = new Map<string, PageInfo>()\n  const pagesManifest = JSON.parse(await fsReadFile(manifestPath, 'utf8'))\n  const buildManifest = JSON.parse(await fsReadFile(buildManifestPath, 'utf8'))\n\n  let customAppGetInitialProps: boolean | undefined\n\n  process.env.NEXT_PHASE = PHASE_PRODUCTION_BUILD\n\n  const staticCheckWorkers = new Worker(staticCheckWorker, {\n    numWorkers: config.experimental.cpus,\n    enableWorkerThreads: true,\n  })\n\n  const analysisBegin = process.hrtime()\n  await Promise.all(\n    pageKeys.map(async page => {\n      const chunks = getPageChunks(page)\n\n      const actualPage = page === '/' ? '/index' : page\n      const size = await getPageSizeInKb(\n        actualPage,\n        distDir,\n        buildId,\n        buildManifest,\n        config.experimental.modern\n      )\n      const bundleRelative = path.join(\n        isLikeServerless ? 'pages' : `static/${buildId}/pages`,\n        actualPage + '.js'\n      )\n      const serverBundle = path.join(\n        distDir,\n        isLikeServerless ? SERVERLESS_DIRECTORY : SERVER_DIRECTORY,\n        bundleRelative\n      )\n\n      let isStatic = false\n\n      pagesManifest[page] = bundleRelative.replace(/\\\\/g, '/')\n\n      const runtimeEnvConfig = {\n        publicRuntimeConfig: config.publicRuntimeConfig,\n        serverRuntimeConfig: config.serverRuntimeConfig,\n      }\n      const nonReservedPage = !page.match(/^\\/(_app|_error|_document|api)/)\n\n      if (nonReservedPage && customAppGetInitialProps === undefined) {\n        customAppGetInitialProps = hasCustomAppGetInitialProps(\n          isLikeServerless\n            ? serverBundle\n            : path.join(\n                distDir,\n                SERVER_DIRECTORY,\n                `/static/${buildId}/pages/_app.js`\n              ),\n          runtimeEnvConfig\n        )\n\n        if (customAppGetInitialProps) {\n          console.warn(\n            chalk.bold.yellow(`Warning: `) +\n              chalk.yellow(\n                `You have opted-out of Automatic Static Optimization due to \\`getInitialProps\\` in \\`pages/_app\\`.`\n              )\n          )\n          console.warn(\n            'Read more: https://err.sh/next.js/opt-out-auto-static-optimization\\n'\n          )\n        }\n      }\n\n      if (nonReservedPage) {\n        try {\n          let result: any = await (staticCheckWorkers as any).isPageStatic(\n            page,\n            serverBundle,\n            runtimeEnvConfig\n          )\n\n          if (result.isHybridAmp) {\n            hybridAmpPages.add(page)\n          }\n\n          if (result.prerender) {\n            sprPages.add(page)\n\n            if (result.prerenderRoutes) {\n              additionalSprPaths.set(page, result.prerenderRoutes)\n            }\n          }\n\n          if (result.static && customAppGetInitialProps === false) {\n            staticPages.add(page)\n            isStatic = true\n          } else if (result.prerender) {\n            sprPages.add(page)\n          }\n        } catch (err) {\n          if (err.message !== 'INVALID_DEFAULT_EXPORT') throw err\n          invalidPages.add(page)\n        }\n      }\n\n      pageInfos.set(page, { size, chunks, serverBundle, static: isStatic })\n    })\n  )\n  staticCheckWorkers.end()\n\n  if (invalidPages.size > 0) {\n    throw new Error(\n      `automatic static optimization failed: found page${\n        invalidPages.size === 1 ? '' : 's'\n      } without a React Component as default export in \\n${[...invalidPages]\n        .map(pg => `pages${pg}`)\n        .join(\n          '\\n'\n        )}\\n\\nSee https://err.sh/zeit/next.js/page-without-valid-component for more info.\\n`\n    )\n  }\n\n  if (Array.isArray(configs[0].plugins)) {\n    configs[0].plugins.some((plugin: any) => {\n      if (!plugin.ampPages) {\n        return false\n      }\n\n      plugin.ampPages.forEach((pg: any) => {\n        pageInfos.get(pg)!.isAmp = true\n      })\n      return true\n    })\n  }\n\n  await writeBuildId(distDir, buildId)\n  const finalPrerenderRoutes: { [route: string]: SprRoute } = {}\n  const tbdPrerenderRoutes: string[] = []\n\n  if (staticPages.size > 0 || sprPages.size > 0) {\n    const combinedPages = [...staticPages, ...sprPages]\n    const exportApp = require('../export').default\n    const exportOptions = {\n      sprPages,\n      silent: true,\n      buildExport: true,\n      pages: combinedPages,\n      outdir: path.join(distDir, 'export'),\n    }\n    const exportConfig: any = {\n      ...config,\n      initialPageRevalidationMap: {},\n      // Default map will be the collection of automatic statically exported\n      // pages and SPR pages.\n      // n.b. we cannot handle this above in combinedPages because the dynamic\n      // page must be in the `pages` array, but not in the mapping.\n      exportPathMap: (defaultMap: any) => {\n        // Remove dynamically routed pages from the default path map. These\n        // pages cannot be prerendered because we don't have enough information\n        // to do so.\n        //\n        // Note: prerendering disables automatic static optimization.\n        sprPages.forEach(page => {\n          if (isDynamicRoute(page)) {\n            tbdPrerenderRoutes.push(page)\n            delete defaultMap[page]\n          }\n        })\n        // Append the \"well-known\" routes we should prerender for, e.g. blog\n        // post slugs.\n        additionalSprPaths.forEach((routes, page) => {\n          routes.forEach(route => {\n            defaultMap[route] = { page }\n          })\n        })\n        return defaultMap\n      },\n      exportTrailingSlash: false,\n    }\n    await exportApp(dir, exportOptions, exportConfig)\n\n    // remove server bundles that were exported\n    for (const page of staticPages) {\n      const { serverBundle } = pageInfos.get(page)!\n      await fsUnlink(serverBundle)\n    }\n\n    const moveExportedPage = async (\n      page: string,\n      file: string,\n      isSpr: boolean,\n      ext: 'html' | 'json'\n    ) => {\n      file = `${file}.${ext}`\n      const orig = path.join(exportOptions.outdir, file)\n      const relativeDest = (isLikeServerless\n        ? path.join('pages', file)\n        : path.join('static', buildId, 'pages', file)\n      ).replace(/\\\\/g, '/')\n\n      const dest = path.join(\n        distDir,\n        isLikeServerless ? SERVERLESS_DIRECTORY : SERVER_DIRECTORY,\n        relativeDest\n      )\n\n      if (!isSpr) {\n        pagesManifest[page] = relativeDest\n        if (page === '/') pagesManifest['/index'] = relativeDest\n        if (page === '/.amp') pagesManifest['/index.amp'] = relativeDest\n      }\n      await mkdirp(path.dirname(dest))\n      await fsMove(orig, dest)\n    }\n\n    for (const page of combinedPages) {\n      const isSpr = sprPages.has(page)\n      const isDynamic = isDynamicRoute(page)\n      let file = page === '/' ? '/index' : page\n      // The dynamic version of SPR pages are not prerendered. Below, we handle\n      // the specific prerenders of these.\n      if (!(isSpr && isDynamic)) {\n        await moveExportedPage(page, file, isSpr, 'html')\n      }\n      const hasAmp = hybridAmpPages.has(page)\n      if (hasAmp) {\n        await moveExportedPage(`${page}.amp`, `${file}.amp`, isSpr, 'html')\n      }\n\n      if (isSpr) {\n        // For a non-dynamic SPR page, we must copy its data file from export.\n        if (!isDynamic) {\n          await moveExportedPage(page, file, true, 'json')\n\n          finalPrerenderRoutes[page] = {\n            initialRevalidateSeconds:\n              exportConfig.initialPageRevalidationMap[page],\n            srcRoute: null,\n            dataRoute: path.posix.join(\n              '/_next/data',\n              `${page === '/' ? '/index' : page}.json`\n            ),\n          }\n        } else {\n          // For a dynamic SPR page, we did not copy its html nor data exports.\n          // Instead, we must copy specific versions of this page as defined by\n          // `unstable_getStaticParams` (additionalSprPaths).\n          const extraRoutes = additionalSprPaths.get(page) || []\n          for (const route of extraRoutes) {\n            await moveExportedPage(route, route, true, 'html')\n            await moveExportedPage(route, route, true, 'json')\n            finalPrerenderRoutes[route] = {\n              initialRevalidateSeconds:\n                exportConfig.initialPageRevalidationMap[route],\n              srcRoute: page,\n              dataRoute: path.posix.join(\n                '/_next/data',\n                `${route === '/' ? '/index' : route}.json`\n              ),\n            }\n          }\n        }\n      }\n    }\n\n    // remove temporary export folder\n    await recursiveDelete(exportOptions.outdir)\n    await fsRmdir(exportOptions.outdir)\n    await fsWriteFile(manifestPath, JSON.stringify(pagesManifest), 'utf8')\n  }\n  if (postBuildSpinner) postBuildSpinner.stopAndPersist()\n  console.log()\n\n  const analysisEnd = process.hrtime(analysisBegin)\n  backgroundWork.push(\n    recordBuildOptimize({\n      durationInSeconds: analysisEnd[0],\n      totalPageCount: pagePaths.length,\n      staticPageCount: staticPages.size,\n      ssrPageCount: pagePaths.length - staticPages.size,\n    })\n  )\n\n  if (sprPages.size > 0) {\n    const finalDynamicRoutes: PrerenderManifest['dynamicRoutes'] = {}\n    tbdPrerenderRoutes.forEach(tbdRoute => {\n      const dataRoute = path.posix.join(\n        '/_next/data',\n        `${tbdRoute === '/' ? '/index' : tbdRoute}.json`\n      )\n\n      finalDynamicRoutes[tbdRoute] = {\n        routeRegex: getRouteRegex(tbdRoute).re.source,\n        dataRoute,\n        dataRouteRegex: getRouteRegex(\n          dataRoute.replace(/\\.json$/, '')\n        ).re.source.replace(/\\(\\?:\\\\\\/\\)\\?\\$$/, '\\\\.json$'),\n      }\n    })\n    const prerenderManifest: PrerenderManifest = {\n      version: 1,\n      routes: finalPrerenderRoutes,\n      dynamicRoutes: finalDynamicRoutes,\n    }\n\n    await fsWriteFile(\n      path.join(distDir, PRERENDER_MANIFEST),\n      JSON.stringify(prerenderManifest),\n      'utf8'\n    )\n  }\n\n  staticPages.forEach(pg => allStaticPages.add(pg))\n  pageInfos.forEach((info: PageInfo, key: string) => {\n    allPageInfos.set(key, info)\n  })\n\n  printTreeView(Object.keys(mappedPages), allPageInfos, isLikeServerless)\n\n  if (tracer) {\n    const parsedResults = await tracer.profiler.stopProfiling()\n    await new Promise(resolve => {\n      if (parsedResults === undefined) {\n        tracer.profiler.destroy()\n        tracer.trace.flush()\n        tracer.end(resolve)\n        return\n      }\n\n      const cpuStartTime = parsedResults.profile.startTime\n      const cpuEndTime = parsedResults.profile.endTime\n\n      tracer.trace.completeEvent({\n        name: 'TaskQueueManager::ProcessTaskFromWorkQueue',\n        id: ++tracer.counter,\n        cat: ['toplevel'],\n        ts: cpuStartTime,\n        args: {\n          src_file: '../../ipc/ipc_moji_bootstrap.cc',\n          src_func: 'Accept',\n        },\n      })\n\n      tracer.trace.completeEvent({\n        name: 'EvaluateScript',\n        id: ++tracer.counter,\n        cat: ['devtools.timeline'],\n        ts: cpuStartTime,\n        dur: cpuEndTime - cpuStartTime,\n        args: {\n          data: {\n            url: 'webpack',\n            lineNumber: 1,\n            columnNumber: 1,\n            frame: '0xFFF',\n          },\n        },\n      })\n\n      tracer.trace.instantEvent({\n        name: 'CpuProfile',\n        id: ++tracer.counter,\n        cat: ['disabled-by-default-devtools.timeline'],\n        ts: cpuEndTime,\n        args: {\n          data: {\n            cpuProfile: parsedResults.profile,\n          },\n        },\n      })\n\n      tracer.profiler.destroy()\n      tracer.trace.flush()\n      tracer.end(resolve)\n    })\n  }\n\n  await Promise.all(backgroundWork).catch(() => {})\n}\n"],"mappings":"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","ignoreList":[]}