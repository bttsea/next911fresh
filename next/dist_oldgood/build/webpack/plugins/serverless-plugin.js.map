{"version":3,"names":["_GraphHelpers","require","ServerlessPlugin","apply","compiler","hooks","compilation","tap","optimizeChunksBasic","chunks","forEach","chunk","hasEntryModule","dynamicChunks","getAllAsyncChunks","size","dynamicChunk","module","modulesIterable","connectChunkAndModule","exports"],"sources":["serverless-plugin.ts"],"sourcesContent":["import { Compiler } from 'webpack'\nimport { connectChunkAndModule } from 'webpack/lib/GraphHelpers'\n\n/**\n * Makes sure there are no dynamic chunks when the target is serverless\n * The dynamic chunks are integrated back into their parent chunk\n * This is to make sure there is a single render bundle instead of that bundle importing dynamic chunks\n */\n\nexport class ServerlessPlugin {\n  apply(compiler: Compiler) {\n    compiler.hooks.compilation.tap('ServerlessPlugin', compilation => {\n      compilation.hooks.optimizeChunksBasic.tap('ServerlessPlugin', chunks => {\n        chunks.forEach(chunk => {\n          // If chunk is not an entry point skip them\n          if (chunk.hasEntryModule()) {\n            const dynamicChunks = chunk.getAllAsyncChunks()\n            if (dynamicChunks.size !== 0) {\n              for (const dynamicChunk of dynamicChunks) {\n                for (const module of dynamicChunk.modulesIterable) {\n                  connectChunkAndModule(chunk, module)\n                }\n              }\n            }\n          }\n        })\n      })\n    })\n  }\n}\n"],"mappings":"qEACA,IAAAA,aAAA,CAAAC,OAAA,6BAEA;AACA;AACA;AACA;AACA,GAEO,KAAM,CAAAC,gBAAiB,CAC5BC,KAAKA,CAACC,QAAkB,CAAE,CACxBA,QAAQ,CAACC,KAAK,CAACC,WAAW,CAACC,GAAG,CAAC,kBAAkB,CAAED,WAAW,EAAI,CAChEA,WAAW,CAACD,KAAK,CAACG,mBAAmB,CAACD,GAAG,CAAC,kBAAkB,CAAEE,MAAM,EAAI,CACtEA,MAAM,CAACC,OAAO,CAACC,KAAK,EAAI,CACtB;AACA,GAAIA,KAAK,CAACC,cAAc,CAAC,CAAC,CAAE,CAC1B,KAAM,CAAAC,aAAa,CAAGF,KAAK,CAACG,iBAAiB,CAAC,CAAC,CAC/C,GAAID,aAAa,CAACE,IAAI,GAAK,CAAC,CAAE,CAC5B,IAAK,KAAM,CAAAC,YAAY,GAAI,CAAAH,aAAa,CAAE,CACxC,IAAK,KAAM,CAAAI,MAAM,GAAI,CAAAD,YAAY,CAACE,eAAe,CAAE,CACjD,GAAAC,mCAAqB,EAACR,KAAK,CAAEM,MAAM,CAAC,CACtC,CACF,CACF,CACF,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CACF,CAACG,OAAA,CAAAlB,gBAAA,CAAAA,gBAAA","ignoreList":[]}