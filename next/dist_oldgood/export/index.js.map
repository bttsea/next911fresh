{"version":3,"names":["_chalk","_interopRequireDefault","require","_fs","_jestWorker","_mkdirp","_os","_path","_util","_index","_spinner","_constants","_recursiveCopy","_recursiveDelete","_constants2","_config","_interopRequireWildcard","_events","_storage","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","mkdirp","promisify","mkdirpModule","copyFile","copyFileOrig","createProgress","total","label","curProgress","progressSpinner","createSpinner","spinner","frames","interval","newText","text","console","log","stop","_default","dir","options","configuration","message","silent","resolve","nextConfig","loadConfig","PHASE_EXPORT","threads","Math","max","cpus","length","distDir","join","buildExport","setTelemetryDir","recordVersion","cliCommand","subFolders","exportTrailingSlash","isLikeServerless","target","Error","existsSync","buildId","readFileSync","BUILD_ID_FILE","pagesManifest","pages","SERVER_DIRECTORY","PAGES_MANIFEST","prerenderManifest","PRERENDER_MANIFEST","_","distPagesDir","SERVERLESS_DIRECTORY","keys","defaultPathMap","page","match","API_ROUTE","outDir","outdir","recursiveDelete","recursiveCopy","CLIENT_STATIC_FILES_PATH","exportPathMap","CONFIG_FILE","defaultMap","renderOpts","nextExport","assetPrefix","replace","dev","staticMarkup","hotReloader","canonicalBase","amp","isModern","experimental","modern","serverRuntimeConfig","publicRuntimeConfig","runtimeConfig","global","__NEXT_DATA__","exportPaths","filteredPaths","filter","route","hasApiRoutes","chalk","yellow","progress","sprDataDir","ampValidations","hadValidationError","publicDir","CLIENT_PUBLIC_FILES_PATH","path","worker","Worker","maxRetries","numWorkers","enableWorkerThreads","exposedMethods","getStdout","pipe","process","stdout","getStderr","stderr","renderError","Promise","all","map","result","pathMap","serverless","isTargetLikeServerless","validation","Array","isArray","errors","error","fromBuildExportRevalidate","initialPageRevalidationMap","end","routes","orig","htmlDest","jsonDest","dirname","formatAmpMessages"],"sources":["index.ts"],"sourcesContent":["import chalk from 'chalk'\nimport { copyFile as copyFileOrig, existsSync, readFileSync } from 'fs'\nimport Worker from 'jest-worker'\nimport mkdirpModule from 'mkdirp'\nimport { cpus } from 'os'\nimport { dirname, join, resolve } from 'path'\nimport { promisify } from 'util'\n\nimport { AmpPageStatus, formatAmpMessages } from '../build/output/index'\nimport createSpinner from '../build/spinner'\nimport { API_ROUTE } from '../lib/constants'\nimport { recursiveCopy } from '../lib/recursive-copy'\nimport { recursiveDelete } from '../lib/recursive-delete'\nimport {\n  BUILD_ID_FILE,\n  CLIENT_PUBLIC_FILES_PATH,\n  CLIENT_STATIC_FILES_PATH,\n  CONFIG_FILE,\n  PAGES_MANIFEST,\n  PHASE_EXPORT,\n  PRERENDER_MANIFEST,\n  SERVER_DIRECTORY,\n  SERVERLESS_DIRECTORY,\n} from '../next-server/lib/constants'\nimport loadConfig, {\n  isTargetLikeServerless,\n} from '../next-server/server/config'\nimport { recordVersion } from '../telemetry/events'\nimport { setDistDir as setTelemetryDir } from '../telemetry/storage'\n\nconst mkdirp = promisify(mkdirpModule)\nconst copyFile = promisify(copyFileOrig)\n\nconst createProgress = (total: number, label = 'Exporting') => {\n  let curProgress = 0\n  let progressSpinner = createSpinner(`${label} (${curProgress}/${total})`, {\n    spinner: {\n      frames: [\n        '[    ]',\n        '[=   ]',\n        '[==  ]',\n        '[=== ]',\n        '[ ===]',\n        '[  ==]',\n        '[   =]',\n        '[    ]',\n        '[   =]',\n        '[  ==]',\n        '[ ===]',\n        '[====]',\n        '[=== ]',\n        '[==  ]',\n        '[=   ]',\n      ],\n      interval: 80,\n    },\n  })\n\n  return () => {\n    curProgress++\n\n    const newText = `${label} (${curProgress}/${total})`\n    if (progressSpinner) {\n      progressSpinner.text = newText\n    } else {\n      console.log(newText)\n    }\n\n    if (curProgress === total && progressSpinner) {\n      progressSpinner.stop()\n      console.log(newText)\n    }\n  }\n}\n\ntype ExportPathMap = {\n  [page: string]: { page: string; query?: { [key: string]: string } }\n}\n\nexport default async function(\n  dir: string,\n  options: any,\n  configuration?: any\n): Promise<void> {\n  function log(message: string) {\n    if (options.silent) {\n      return\n    }\n    console.log(message)\n  }\n\n  dir = resolve(dir)\n  const nextConfig = configuration || loadConfig(PHASE_EXPORT, dir)\n  const threads = options.threads || Math.max(cpus().length - 1, 1)\n  const distDir = join(dir, nextConfig.distDir)\n  if (!options.buildExport) {\n    setTelemetryDir(distDir)\n    recordVersion({ cliCommand: 'export' })\n  }\n\n  const subFolders = nextConfig.exportTrailingSlash\n  const isLikeServerless = nextConfig.target !== 'server'\n\n  if (!options.buildExport && isLikeServerless) {\n    throw new Error(\n      'Cannot export when target is not server. https://err.sh/zeit/next.js/next-export-serverless'\n    )\n  }\n\n  log(`> using build directory: ${distDir}`)\n\n  if (!existsSync(distDir)) {\n    throw new Error(\n      `Build directory ${distDir} does not exist. Make sure you run \"next build\" before running \"next start\" or \"next export\".`\n    )\n  }\n\n  const buildId = readFileSync(join(distDir, BUILD_ID_FILE), 'utf8')\n  const pagesManifest =\n    !options.pages && require(join(distDir, SERVER_DIRECTORY, PAGES_MANIFEST))\n\n  let prerenderManifest\n  try {\n    prerenderManifest = require(join(distDir, PRERENDER_MANIFEST))\n  } catch (_) {}\n\n  const distPagesDir = join(\n    distDir,\n    isLikeServerless\n      ? SERVERLESS_DIRECTORY\n      : join(SERVER_DIRECTORY, 'static', buildId),\n    'pages'\n  )\n\n  const pages = options.pages || Object.keys(pagesManifest)\n  const defaultPathMap: ExportPathMap = {}\n\n  for (const page of pages) {\n    // _document and _app are not real pages\n    // _error is exported as 404.html later on\n    // API Routes are Node.js functions\n    if (\n      page === '/_document' ||\n      page === '/_app' ||\n      page === '/_error' ||\n      page.match(API_ROUTE)\n    ) {\n      continue\n    }\n\n    defaultPathMap[page] = { page }\n  }\n\n  // Initialize the output directory\n  const outDir = options.outdir\n\n  if (outDir === join(dir, 'public')) {\n    throw new Error(\n      `The 'public' directory is reserved in Next.js and can not be used as the export out directory. https://err.sh/zeit/next.js/can-not-output-to-public`\n    )\n  }\n\n  await recursiveDelete(join(outDir))\n  await mkdirp(join(outDir, '_next', buildId))\n\n  // Copy static directory\n  if (!options.buildExport && existsSync(join(dir, 'static'))) {\n    log('  copying \"static\" directory')\n    await recursiveCopy(join(dir, 'static'), join(outDir, 'static'))\n  }\n\n  // Copy .next/static directory\n  if (existsSync(join(distDir, CLIENT_STATIC_FILES_PATH))) {\n    log('  copying \"static build\" directory')\n    await recursiveCopy(\n      join(distDir, CLIENT_STATIC_FILES_PATH),\n      join(outDir, '_next', CLIENT_STATIC_FILES_PATH)\n    )\n  }\n\n  // Get the exportPathMap from the config file\n  if (typeof nextConfig.exportPathMap !== 'function') {\n    console.log(\n      `> No \"exportPathMap\" found in \"${CONFIG_FILE}\". Generating map from \"./pages\"`\n    )\n    nextConfig.exportPathMap = async (defaultMap: ExportPathMap) => {\n      return defaultMap\n    }\n  }\n\n  // Start the rendering process\n  const renderOpts = {\n    dir,\n    buildId,\n    nextExport: true,\n    assetPrefix: nextConfig.assetPrefix.replace(/\\/$/, ''),\n    distDir,\n    dev: false,\n    staticMarkup: false,\n    hotReloader: null,\n    canonicalBase: (nextConfig.amp && nextConfig.amp.canonicalBase) || '',\n    isModern: nextConfig.experimental.modern,\n  }\n\n  const { serverRuntimeConfig, publicRuntimeConfig } = nextConfig\n\n  if (Object.keys(publicRuntimeConfig).length > 0) {\n    ;(renderOpts as any).runtimeConfig = publicRuntimeConfig\n  }\n\n  // We need this for server rendering the Link component.\n  ;(global as any).__NEXT_DATA__ = {\n    nextExport: true,\n  }\n\n  log(`  launching ${threads} workers`)\n  const exportPathMap = await nextConfig.exportPathMap(defaultPathMap, {\n    dev: false,\n    dir,\n    outDir,\n    distDir,\n    buildId,\n  })\n  if (!exportPathMap['/404']) {\n    exportPathMap['/404.html'] = exportPathMap['/404.html'] || {\n      page: '/_error',\n    }\n  }\n  const exportPaths = Object.keys(exportPathMap)\n  const filteredPaths = exportPaths.filter(\n    // Remove API routes\n    route => !exportPathMap[route].page.match(API_ROUTE)\n  )\n  const hasApiRoutes = exportPaths.length !== filteredPaths.length\n\n  // Warn if the user defines a path for an API page\n  if (hasApiRoutes) {\n    log(\n      chalk.yellow(\n        '  API pages are not supported by next export. https://err.sh/zeit/next.js/api-routes-static-export'\n      )\n    )\n  }\n\n  const progress = !options.silent && createProgress(filteredPaths.length)\n  const sprDataDir = options.buildExport ? outDir : join(outDir, '_next/data')\n\n  const ampValidations: AmpPageStatus = {}\n  let hadValidationError = false\n\n  const publicDir = join(dir, CLIENT_PUBLIC_FILES_PATH)\n  // Copy public directory\n  if (!options.buildExport && existsSync(publicDir)) {\n    log('  copying \"public\" directory')\n    await recursiveCopy(publicDir, outDir, {\n      filter(path) {\n        // Exclude paths used by pages\n        return !exportPathMap[path]\n      },\n    })\n  }\n\n  const worker: Worker & { default: Function } = new Worker(\n    require.resolve('./worker'),\n    {\n      maxRetries: 0,\n      numWorkers: threads,\n      enableWorkerThreads: true,\n      exposedMethods: ['default'],\n    }\n  ) as any\n\n  worker.getStdout().pipe(process.stdout)\n  worker.getStderr().pipe(process.stderr)\n\n  let renderError = false\n\n  await Promise.all(\n    filteredPaths.map(async path => {\n      const result = await worker.default({\n        path,\n        pathMap: exportPathMap[path],\n        distDir,\n        buildId,\n        outDir,\n        sprDataDir,\n        renderOpts,\n        serverRuntimeConfig,\n        subFolders,\n        buildExport: options.buildExport,\n        serverless: isTargetLikeServerless(nextConfig.target),\n      })\n\n      for (const validation of result.ampValidations || []) {\n        const { page, result } = validation\n        ampValidations[page] = result\n        hadValidationError =\n          hadValidationError ||\n          (Array.isArray(result && result.errors) && result.errors.length > 0)\n      }\n      renderError = renderError || !!result.error\n\n      if (\n        options.buildExport &&\n        typeof result.fromBuildExportRevalidate !== 'undefined'\n      ) {\n        configuration.initialPageRevalidationMap[path] =\n          result.fromBuildExportRevalidate\n      }\n      if (progress) progress()\n    })\n  )\n\n  worker.end()\n\n  // copy prerendered routes to outDir\n  if (!options.buildExport && prerenderManifest) {\n    await Promise.all(\n      Object.keys(prerenderManifest.routes).map(async route => {\n        route = route === '/' ? '/index' : route\n        const orig = join(distPagesDir, route)\n        const htmlDest = join(outDir, `${route}.html`)\n        const jsonDest = join(sprDataDir, `${route}.json`)\n\n        await mkdirp(dirname(htmlDest))\n        await mkdirp(dirname(jsonDest))\n        await copyFile(`${orig}.html`, htmlDest)\n        await copyFile(`${orig}.json`, jsonDest)\n      })\n    )\n  }\n\n  if (Object.keys(ampValidations).length) {\n    console.log(formatAmpMessages(ampValidations))\n  }\n  if (hadValidationError) {\n    throw new Error(\n      `AMP Validation caused the export to fail. https://err.sh/zeit/next.js/amp-export-validation`\n    )\n  }\n\n  if (renderError) {\n    throw new Error(`Export encountered errors`)\n  }\n  // Add an empty line to the console for the better readability.\n  log('')\n}\n"],"mappings":"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","ignoreList":[]}