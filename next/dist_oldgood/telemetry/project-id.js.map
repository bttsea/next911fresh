{"version":3,"names":["_child_process","require","_storage","_getProjectIdByGit","originBuffer","execSync","timeout","stdio","String","trim","_","getProjectId","projectId","process","env","REPOSITORY_URL","cwd","computeHash","toLowerCase"],"sources":["project-id.ts"],"sourcesContent":["import { execSync } from 'child_process'\nimport { computeHash } from './storage'\n\n// Q: Why does Next.js need a project ID? Why is it looking at my git remote?\n// A:\n// Next.js' telemetry is and always will be completely anonymous. Because of\n// this, we need a way to differentiate different projects to track feature\n// usage accurately. For example, to prevent a feature from appearing to be\n// constantly `used` and then `unused` when switching between local projects.\n// To reiterate,\n// we **never** can read your actual git remote. The value is hashed one-way\n// with random salt data, making it impossible for us to reverse or try to\n// guess the remote by re-computing hashes.\n\nfunction _getProjectIdByGit() {\n  try {\n    const originBuffer = execSync(\n      `git config --local --get remote.origin.url`,\n      {\n        timeout: 1000,\n        stdio: `pipe`,\n      }\n    )\n\n    return String(originBuffer).trim()\n  } catch (_) {\n    return null\n  }\n}\n\nexport function getProjectId(): string {\n  const projectId =\n    _getProjectIdByGit() || process.env.REPOSITORY_URL || process.cwd()\n\n  // Compute a one-way, salted hash of the project ID. This value cannot be\n  // reversed.\n  // See the top of the file for a more detailed reason why we ask for this\n  // data.\n  return computeHash(projectId.trim().toLowerCase()) || ''\n}\n"],"mappings":"uEAAA,IAAAA,cAAA,CAAAC,OAAA,kBACA,IAAAC,QAAA,CAAAD,OAAA,cAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,QAAS,CAAAE,kBAAkBA,CAAA,CAAG,CAC5B,GAAI,CACF,KAAM,CAAAC,YAAY,CAAG,GAAAC,uBAAQ,EAC3B,4CAA4C,CAC5C,CACEC,OAAO,CAAE,IAAI,CACbC,KAAK,CAAE,MACT,CACF,CAAC,CAED,MAAO,CAAAC,MAAM,CAACJ,YAAY,CAAC,CAACK,IAAI,CAAC,CAAC,CACpC,CAAE,MAAOC,CAAC,CAAE,CACV,MAAO,KAAI,CACb,CACF,CAEO,QAAS,CAAAC,YAAYA,CAAA,CAAW,CACrC,KAAM,CAAAC,SAAS,CACbT,kBAAkB,CAAC,CAAC,EAAIU,OAAO,CAACC,GAAG,CAACC,cAAc,EAAIF,OAAO,CAACG,GAAG,CAAC,CAAC,CAErE;AACA;AACA;AACA;AACA,MAAO,GAAAC,oBAAW,EAACL,SAAS,CAACH,IAAI,CAAC,CAAC,CAACS,WAAW,CAAC,CAAC,CAAC,EAAI,EAAE,CAC1D","ignoreList":[]}