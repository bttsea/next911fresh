{"version":3,"names":["_storage","require","_findUp","_interopRequireDefault","e","__esModule","default","EVENT_PLUGIN_PRESENT","plugins","recordNextPlugins","dir","packageJsonPath","findUp","cwd","dependencies","devDependencies","record","map","plugin","version","pluginName","pluginVersion","filter","Boolean","eventName","payload","packageName","packageVersion","_"],"sources":["plugins.ts"],"sourcesContent":["import { record } from '../storage'\nimport findUp from 'find-up'\n\nconst EVENT_PLUGIN_PRESENT = 'NEXT_PACKAGE_DETECTED'\ntype EventPackageDetected = {\n  packageName: string\n  packageVersion: string\n}\n\nconst plugins = [\n  // CSS-in-JS solutions\n  'styled-components',\n  'radium',\n  'aphrodite',\n  'emotion',\n  'glamorous',\n  'glamor',\n  'fela',\n  'react-jss',\n  'linaria',\n  'typestyle',\n  // Modern Plugins\n  '@next/bundle-analyzer',\n  '@next/mdx',\n  // Legacy Plugins\n  '@zeit/next-bundle-analyzer',\n  '@zeit/next-css',\n  '@zeit/next-less',\n  '@zeit/next-mdx',\n  '@zeit/next-preact',\n  '@zeit/next-sass',\n  '@zeit/next-source-maps',\n  '@zeit/next-stylus',\n  '@zeit/next-typescript',\n  '@zeit/next-workers',\n  // Community Plugins\n  'next-env',\n  'next-offline',\n  'next-optimized-images',\n  'next-runtime-dotenv',\n  'next-progressbar',\n  'next-transpile-modules',\n  'next-react-svg',\n  '@weco/next-plugin-transpile-modules',\n  'next-images',\n  'next-videos',\n  'next-compose-plugins',\n  'next-build-id',\n  'next-routes',\n  'next-router',\n  'next-mdx-enhanced',\n  'next-docify',\n  'next-i18next',\n  'next-redux-saga',\n  'nookies',\n  'next-aws-lambda',\n  'serverless-nextjs-plugin',\n  'next-plugin-styled-icons',\n  '@ematipico/terraform-nextjs-plugin',\n  'next-mui-helper',\n  'nextjs-mui-helper',\n  'next-router-events',\n  '@moxy/next-runtime-env',\n  'next-session',\n  'next-apollo',\n  'next-minimal-routes',\n  'next-router-components',\n  'next-page-loading-bar',\n  'next-flexible-routes',\n  'next-apollo-hoc',\n  'routex.js',\n  'nextron',\n  'next-ga',\n  'nextjs-redirect',\n  'next-mobx-wrapper',\n  'next-ym',\n  'next-contentful',\n  'f-next-ga',\n  'next-plugin-yaml',\n  'data-prefetch-link',\n  'next-helpers',\n  'next-plugin-modernizr',\n  'nextjs-wp',\n  'nextjs-middleware',\n  'nextscript',\n  'next-fbq',\n  'next-analytics',\n  '@engineerapart/nextscript',\n  'next-data-link',\n  '@blunck/next-alias',\n  '@blunck/next-html',\n  'next-universal-redirect',\n  'create-next-app-lite',\n  'next-babel-minify',\n  '@rpominov/reason-next',\n  'create-next-library',\n  'nextscriptnew',\n  'nextjs-sitemap-generator',\n  '@dmartss/with-nprogress',\n  'create-react-next-app',\n  'hapi-nextjs',\n  '@cotype/serverless-next',\n  'nextjs-auth-hoc',\n  '@preco21/next-fonts',\n  '@dmartss/next-hoc',\n  '@xiphe/serverless-nextjs-plugin',\n  '@yellowiki/next-nprogress',\n  '@hashicorp/next-prebuild',\n  'next-i18next2.0',\n  '@futpib/next-ga',\n  'next-url-prettifier',\n  'next-plugin-custom-babel-config',\n  'fastify-nextjs',\n  '@yolkai/next-routes',\n  'trovit-next-routes',\n  'next-routify',\n  'wtp-next-routes',\n  '@whatoplay/next-routes',\n  '@ninetynine/next-routes',\n  'electron-next',\n  '@palmabit/sacajawea',\n  'advanced-next-routes',\n  'next-useragent',\n  'next-routes-with-locale',\n  'next-cookie',\n  'next-i18n-routes',\n  'next-graphql-react',\n  'next-flash-messages',\n  'next-manifest',\n  'next-purgecss',\n  'next-theme-webpack-plugin',\n  'next-serverless',\n  'connected-next-router',\n  'cookies-next',\n  'bs-next-alt',\n  'bs-next',\n  'next-redux',\n  'next-awesome-typescript',\n  'next-applicationinsights',\n  'next-routes-2',\n  'next-spa',\n  'next-precache',\n  'next-dynamic-routes',\n  'next-lambda',\n  'next-workbox',\n  'next-inferno',\n  'next-isserver',\n  '@alicd/next-locale-provider',\n  'shower-next',\n  'next-md',\n  '@primer/next',\n  'next-pages',\n  'amplify-next',\n  'create-next-app',\n  'neutron',\n  'react-intl',\n  'react-intl-universal',\n  '@lingui/react',\n  '@apollo/react-ssr',\n]\n\nexport async function recordNextPlugins(dir: string) {\n  try {\n    const packageJsonPath = await findUp('package.json', { cwd: dir })\n    if (!packageJsonPath) {\n      return\n    }\n\n    const { dependencies = {}, devDependencies = {} } = require(packageJsonPath)\n    return record(\n      (plugins\n        .map(plugin => {\n          const version = dependencies[plugin] || devDependencies[plugin]\n          if (version) {\n            return { pluginName: plugin, pluginVersion: version }\n          }\n        })\n        .filter(Boolean) as {\n        pluginName: string\n        pluginVersion: string\n      }[]).map(({ pluginName, pluginVersion }) => ({\n        eventName: EVENT_PLUGIN_PRESENT,\n        payload: {\n          packageName: pluginName,\n          packageVersion: pluginVersion,\n        } as EventPackageDetected,\n      }))\n    )\n  } catch (_) {}\n}\n"],"mappings":"iFAAA,IAAAA,QAAA,CAAAC,OAAA,eACA,IAAAC,OAAA,CAAAC,sBAAA,CAAAF,OAAA,aAA4B,SAAAE,uBAAAC,CAAA,SAAAA,CAAA,EAAAA,CAAA,CAAAC,UAAA,CAAAD,CAAA,EAAAE,OAAA,CAAAF,CAAA,GAE5B,KAAM,CAAAG,oBAAoB,CAAG,uBAAuB,CAMpD,KAAM,CAAAC,OAAO,CAAG,CACd;AACA,mBAAmB,CACnB,QAAQ,CACR,WAAW,CACX,SAAS,CACT,WAAW,CACX,QAAQ,CACR,MAAM,CACN,WAAW,CACX,SAAS,CACT,WAAW,CACX;AACA,uBAAuB,CACvB,WAAW,CACX;AACA,4BAA4B,CAC5B,gBAAgB,CAChB,iBAAiB,CACjB,gBAAgB,CAChB,mBAAmB,CACnB,iBAAiB,CACjB,wBAAwB,CACxB,mBAAmB,CACnB,uBAAuB,CACvB,oBAAoB,CACpB;AACA,UAAU,CACV,cAAc,CACd,uBAAuB,CACvB,qBAAqB,CACrB,kBAAkB,CAClB,wBAAwB,CACxB,gBAAgB,CAChB,qCAAqC,CACrC,aAAa,CACb,aAAa,CACb,sBAAsB,CACtB,eAAe,CACf,aAAa,CACb,aAAa,CACb,mBAAmB,CACnB,aAAa,CACb,cAAc,CACd,iBAAiB,CACjB,SAAS,CACT,iBAAiB,CACjB,0BAA0B,CAC1B,0BAA0B,CAC1B,oCAAoC,CACpC,iBAAiB,CACjB,mBAAmB,CACnB,oBAAoB,CACpB,wBAAwB,CACxB,cAAc,CACd,aAAa,CACb,qBAAqB,CACrB,wBAAwB,CACxB,uBAAuB,CACvB,sBAAsB,CACtB,iBAAiB,CACjB,WAAW,CACX,SAAS,CACT,SAAS,CACT,iBAAiB,CACjB,mBAAmB,CACnB,SAAS,CACT,iBAAiB,CACjB,WAAW,CACX,kBAAkB,CAClB,oBAAoB,CACpB,cAAc,CACd,uBAAuB,CACvB,WAAW,CACX,mBAAmB,CACnB,YAAY,CACZ,UAAU,CACV,gBAAgB,CAChB,2BAA2B,CAC3B,gBAAgB,CAChB,oBAAoB,CACpB,mBAAmB,CACnB,yBAAyB,CACzB,sBAAsB,CACtB,mBAAmB,CACnB,uBAAuB,CACvB,qBAAqB,CACrB,eAAe,CACf,0BAA0B,CAC1B,yBAAyB,CACzB,uBAAuB,CACvB,aAAa,CACb,yBAAyB,CACzB,iBAAiB,CACjB,qBAAqB,CACrB,mBAAmB,CACnB,iCAAiC,CACjC,2BAA2B,CAC3B,0BAA0B,CAC1B,iBAAiB,CACjB,iBAAiB,CACjB,qBAAqB,CACrB,iCAAiC,CACjC,gBAAgB,CAChB,qBAAqB,CACrB,oBAAoB,CACpB,cAAc,CACd,iBAAiB,CACjB,wBAAwB,CACxB,yBAAyB,CACzB,eAAe,CACf,qBAAqB,CACrB,sBAAsB,CACtB,gBAAgB,CAChB,yBAAyB,CACzB,aAAa,CACb,kBAAkB,CAClB,oBAAoB,CACpB,qBAAqB,CACrB,eAAe,CACf,eAAe,CACf,2BAA2B,CAC3B,iBAAiB,CACjB,uBAAuB,CACvB,cAAc,CACd,aAAa,CACb,SAAS,CACT,YAAY,CACZ,yBAAyB,CACzB,0BAA0B,CAC1B,eAAe,CACf,UAAU,CACV,eAAe,CACf,qBAAqB,CACrB,aAAa,CACb,cAAc,CACd,cAAc,CACd,eAAe,CACf,6BAA6B,CAC7B,aAAa,CACb,SAAS,CACT,cAAc,CACd,YAAY,CACZ,cAAc,CACd,iBAAiB,CACjB,SAAS,CACT,YAAY,CACZ,sBAAsB,CACtB,eAAe,CACf,mBAAmB,CACpB,CAEM,cAAe,CAAAC,iBAAiBA,CAACC,GAAW,CAAE,CACnD,GAAI,CACF,KAAM,CAAAC,eAAe,CAAG,KAAM,GAAAC,eAAM,EAAC,cAAc,CAAE,CAAEC,GAAG,CAAEH,GAAI,CAAC,CAAC,CAClE,GAAI,CAACC,eAAe,CAAE,CACpB,OACF,CAEA,KAAM,CAAEG,YAAY,CAAG,CAAC,CAAC,CAAEC,eAAe,CAAG,CAAC,CAAE,CAAC,CAAGd,OAAO,CAACU,eAAe,CAAC,CAC5E,MAAO,GAAAK,eAAM,EACVR,OAAO,CACLS,GAAG,CAACC,MAAM,EAAI,CACb,KAAM,CAAAC,OAAO,CAAGL,YAAY,CAACI,MAAM,CAAC,EAAIH,eAAe,CAACG,MAAM,CAAC,CAC/D,GAAIC,OAAO,CAAE,CACX,MAAO,CAAEC,UAAU,CAAEF,MAAM,CAAEG,aAAa,CAAEF,OAAQ,CAAC,CACvD,CACF,CAAC,CAAC,CACDG,MAAM,CAACC,OAAO,CAAC,CAGbN,GAAG,CAAC,CAAC,CAAEG,UAAU,CAAEC,aAAc,CAAC,IAAM,CAC3CG,SAAS,CAAEjB,oBAAoB,CAC/BkB,OAAO,CAAE,CACPC,WAAW,CAAEN,UAAU,CACvBO,cAAc,CAAEN,aAClB,CACF,CAAC,CAAC,CACJ,CAAC,CACH,CAAE,MAAOO,CAAC,CAAE,CAAC,CACf","ignoreList":[]}